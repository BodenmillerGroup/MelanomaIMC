---
title: "clinical data summary"
author: "daniels"
date: "9 4 2020"
output:
  html_document: 
    self_contained: no
  pdf_document: default
---

# Introduction
This script gives an overview over the clinical data and generates statistics used in the manuscript.

# Preparations

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message= FALSE)
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
```

## Load libraries

```{r load libraries}
sapply(list.files("code/helper_functions", full.names = TRUE), source)
library(data.table)
library(survival)
library(ggplot2)
library(broom)
library(dplyr)
library(RColorBrewer)
library(ggalluvial)
library(tidyverse)
library(cowplot)
```

## Load Data

```{r}
# clinical data
dat <- read_csv("data/protein/clinical_data_protein.csv")

# SCE object
sce_protein = readRDS(file = "data/sce_protein.rds")
sce_rna = readRDS(file = "data/sce_RNA.rds")
```

# Statistics

## Number of Samples and Patients

```{r}
# Number of Samples without control samples
data.frame(colData(sce_protein)) %>%
  filter(Location != "CTRL") %>%
  distinct(Description) %>%
  summarise(n=n())

# Number of Patients
data.frame(colData(sce_protein)) %>%
  filter(Location != "CTRL") %>%
  distinct(PatientID) %>%
  summarise(n=n())
```

## Number of Celltypes

```{r}
# Protein data
data.frame(colData(sce_protein)) %>%
  filter(Location != "CTRL") %>%
  group_by(celltype) %>%
  summarise(n=n())

# RNA data
data.frame(colData(sce_rna)) %>%
  filter(Location != "CTRL") %>%
  group_by(celltype) %>%
  summarise(n=n())
```

